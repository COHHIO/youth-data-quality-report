---
title: Data Quality Report
subtitle: TODO
execute:
  echo: false
params:
  period_start_date: "2025-07-01"
  period_end_date: "2025-09-30"
---

```{r set-default-params-for-interactive-development}
# Set default params for interactive development
if (!exists("params")) {
    params <- list(
        period_start_date = "2025-07-01",
        period_end_date = "2025-09-30"
    )
}
```

```{r make-params-available-to-included-documents}
# Make params available to included documents
period_start_date <- params$period_start_date
period_end_date <- params$period_end_date
```

{{< include /qmd/_00_01_utils.qmd >}}

{{< include /qmd/_00_02_process_data.qmd >}}

## Universal Data Elements

There were `r nrow(enrollments_in_period)` enrollments between `r period_start_date` and `r period_end_date`.

```{r check-duplicated-enrollment-id}
#| results: asis
n_duplicated_enrollment_ids <- enrollments_in_period |>
    dplyr::count(enrollment_id) |>
    dplyr::filter(n > 1) |>
    nrow()

n_duplicated_enrollment_ids_string <- ifelse(
    n_duplicated_enrollment_ids == 0,
    "✅ There are no duplicated enrollment IDs.",
    paste0("❌ There are ", n_duplicated_enrollment_ids, " duplicated enrollment IDs.")
)

cat(n_duplicated_enrollment_ids_string)
```

### Social Security Number

SSN data is recorded in two fields:

- Social Security Number
- SSN Data Quality

```{r check-ssn-data}
data_enrollment |>
    create_data_quality_table(
        response_column = "ssn_data_quality",
        combine_responses = FALSE,
        group_column = "ssn_length",
        group_column_label = "SSN Length",
        table_title = "SSN Data Quality and SSN Length"
    ) |>
    gt::cols_width(
        data_quality_status ~ gt::pct(49),
        gt::everything() ~ gt::pct(17)
    )
```

### Date of Birth

### Race and Ethnicity

### Veteran Status

```{r check-veteran-status-responses}
data_enrollment |>
    create_data_quality_table(
        response_column = "veteran_status",
        group_column = "is_adult",
        group_column_label = "Adult",
        table_title = "Veteran Status Data Quality"
    )
```

### Relationship to Head of Household

### Prior Living Situation
```{r check-prior-living-situation-responses}
data_enrollment |>
    create_data_quality_table(
        response_column = "living_situation",
        group_column = "is_hoh_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Prior Living Situation"
    )
```

## Federal Partner Program Specific Data Elements

### RHY

#### Referral Source

```{r check-referral-source-responses}
data_enrollment |>
    create_data_quality_table(
        response_column = "referral_source",
        group_column = "is_hoh_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Referral Source"
    )
```

#### Formerly a Ward of Child Welfare/Foster Care Agency

```{r check-formerly-ward-of-child-welfare-foster-care-agency}
data_enrollment |>
    create_data_quality_table(
        response_column = "former_ward_child_welfare",
        group_column = "is_hoh_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Formerly a Ward of Child Welfare/Foster Care Agency"
    )
```

#### Formerly a Ward of Juvenile Justice System

```{r check-formerly-ward-of-juvenile-justice-system}
data_enrollment |>
    create_data_quality_table(
        response_column = "former_ward_juvenile_justice",
        group_column = "is_hoh_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Formerly a Ward of Juvenile Justice System"
    )
```

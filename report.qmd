---
title: Data Quality Report
subtitle: TODO
execute:
  echo: false
params:
  period_start_date: "2025-07-01"
  period_end_date: "2025-09-30"
---

```{r set-default-params-for-interactive-development}
# Set default params for interactive development
if (!exists("params")) {
    params <- list(
        period_start_date = lubridate::ymd("2025-07-01"),
        period_end_date = lubridate::ymd("2025-09-30")
    )
}
```

```{r make-params-available-to-included-documents}
# Make params available to included documents
period_start_date <- lubridate::ymd(params$period_start_date)
period_end_date <- lubridate::ymd(params$period_end_date)
```

```{r load-data-and-utils}
purrr::walk(
  .x = list.files("R", full.names = TRUE),
  .f = source
)
```

## Overview

During the period from `r format(period_start_date, "%m/%d/%Y")` to `r format(period_end_date, "%m/%d/%Y")` there are:

- **`r nrow(entries_in_period)` enrollments** from **`r dplyr::n_distinct(data_enrollment_client$household_id)` distinct households**
- **`r nrow(exits_in_period)` exits**

```{r check-duplicated-enrollment-id}
#| results: asis
n_duplicated_enrollment_ids <- entries_in_period |>
    dplyr::count(enrollment_id) |>
    dplyr::filter(n > 1) |>
    nrow()

n_duplicated_enrollment_ids_string <- ifelse(
    n_duplicated_enrollment_ids == 0,
    "✅ There are no duplicated enrollment IDs.",
    paste0("❌ There are ", n_duplicated_enrollment_ids, " duplicated enrollment IDs.")
)

cat(n_duplicated_enrollment_ids_string)
```

```{r check-one-head-of-household-per-household}
#| results: asis
distinct_n_hoh_per_h <- data_enrollment_client |>
    dplyr::summarise(
        n_hoh = sum(relationship_to_ho_h == "Self (head of household)"),
        .by = "household_id"
    ) |>
    dplyr::count(n_hoh) |>
    dplyr::pull(n_hoh)

if (length(distinct_n_hoh_per_h) == 1 && distinct_n_hoh_per_h == 1) {
    cat("✅ All households have exactly one head of household.")
} else {
    if (0 %in% distinct_n_hoh_per_h) {
        cat("❌ Some households are missing a head of household.")
    }
    if (any(distinct_n_hoh_per_h > 1)) {
        cat("❌ Some households have more than one head of household.")
    }
}
```

```{r check-exit-associated-with-enrollment}
#| results: asis
n_exits_without_an_enrollment_record <- exits_in_period |>
    dplyr::anti_join(
        y = dm$enrollment,
        by = c("enrollment_id", "personal_id", "organization_id")
    ) |>
    nrow()

if (n_exits_without_an_enrollment_record == 0) {
    cat("✅ All exits are associated with an enrollment.")
} else {
    cat(glue::glue("❌ { n_exits_without_an_enrollment_record } aren't associated with an enrollment."))
}
```

### Responses Summary

```{r summarise-pct-responses-by-collection-point}
summary_by_collection_point <- summarise_pct_responses(summary_params, column_config)
```

#### Collection Point: Project Start

```{r summary-entry}
summary_by_collection_point$entry |>
    dplyr::mutate(responses = paste0(n, "/", denominator)) |>
    dplyr::arrange(dplyr::desc(pct)) |>
    dplyr::select(label, responses, pct) |>
    gt::gt() |>
    gt::cols_label(
        label = "Data Element",
        responses = "Responses",
        pct = "% Responses"
    ) |>
    gt::fmt_percent(
        columns = pct,
        decimals = 1
    ) |>
    gt::cols_width(
        label ~ gt::pct(50),
        gt::everything() ~ gt::pct(20)
    ) |>
    gt::tab_options(
        table.font.names = "Roboto"
    )
```

#### Collection Point: Project Exit

```{r summary-exit}
summary_by_collection_point$exit |>
    dplyr::mutate(responses = paste0(n, "/", denominator)) |>
    dplyr::arrange(dplyr::desc(pct)) |>
    dplyr::select(label, responses, pct) |>
    gt::gt() |>
    gt::cols_label(
        label = "Data Element",
        responses = "Responses",
        pct = "% Responses"
    ) |>
    gt::fmt_percent(
        columns = pct,
        decimals = 1
    ) |>
    gt::cols_width(
        label ~ gt::pct(50),
        gt::everything() ~ gt::pct(20)
    ) |>
    gt::tab_options(
        table.font.names = "Roboto"
    )

```

#### Collection Point: Project Start and Project Exit

```{r summary-entry-exit}
summary_by_collection_point$entry_exit |>
    dplyr::mutate(
        responses_entry = paste0(n_entry, "/", denominator_entry),
        responses_exit = paste0(n_exit, "/", denominator_exit)
    ) |>
    dplyr::arrange(dplyr::desc(pct_entry)) |>
    dplyr::select(label, responses_entry, pct_entry, responses_exit, pct_exit) |>
    gt::gt() |>
    gt::tab_spanner(
        label = "Entry Responses",
        columns = tidyselect::contains("entry")
    ) |>
    gt::tab_spanner(
        label = "Exit Responses",
        columns = tidyselect::contains("exit")
    ) |>
    gt::cols_label(
        label = "Data Element",
        responses_entry = "Count",
        responses_exit = "Count",
        pct_entry = "Percent",
        pct_exit = "Percent"
    ) |>
    gt::fmt_percent(
        columns = tidyselect::starts_with("pct"),
        decimals = 1
    ) |>
    gt::tab_style(
        style = gt::cell_text(v_align = "middle"),
        locations = gt::cells_column_labels(
            columns = label
        )
    ) |>
    gt::cols_width(
        label ~ gt::pct(44),
        gt::everything() ~ gt::pct(14)
    ) |>
    gt::tab_options(
        table.font.names = "Roboto"
    )
```

## Universal Data Elements

### Social Security Number

SSN data is recorded in two fields:

- Social Security Number
- SSN Data Quality

```{r check-ssn-responses}
data_enrollment_client |>
    create_data_quality_table(
        response_column = "ssn_data_quality",
        combine_responses = FALSE,
        group_column = "ssn_length",
        group_column_label = "SSN Length",
        table_title = "SSN Data Quality and SSN Length"
    ) |>
    gt::cols_width(
        data_quality_status ~ gt::pct(49),
        gt::everything() ~ gt::pct(17)
    )
```

### Date of Birth

```{r check-age-range}
#| results: asis
min_age <- min(data_enrollment_client$age, na.rm = TRUE)
max_age <- max(data_enrollment_client$age, na.rm = TRUE)

cat(paste0("Clients reported ages ranging from ", min_age, " to ", max_age, " years."))
```

```{r check-missing-age}
#| results: asis
n_missing_age <- data_enrollment_client |>
    dplyr::filter(age_grouped == "Missing") |>
    nrow()

n_missing_age_string <- ifelse(
    n_missing_age == 0,
    "✅ All clients reported an age value.",
    paste0("⚠️ ", n_missing_age, " client", ifelse(n_missing_age > 1, "s", ""), " reported no age value.")
)

cat(n_missing_age_string)
```

```{r check-age-distribution}
data_enrollment_client |>
    ggplot2::ggplot() +
    ggplot2::geom_histogram(
        mapping = ggplot2::aes(x = age),
        binwidth = 3,
        boundary = 0,
        closed = "left",
        fill = palette$light_blue,
        color = palette$navy_blue
    ) +
    ggplot2::scale_x_continuous(
        breaks = seq(
            floor(min(min_age, 0) / 3) * 3,
            ceiling(max_age / 3) * 3,
            3
        )
    ) +
    ggplot2::scale_y_continuous(
        expand = ggplot2::expansion(mult = c(0, 0.15))
    ) +
    ggplot2::labs(
        title = "Clients by Age",
        x = "Age (Years)",
        y = "Count"
    ) +
    ggplot2::theme_bw()
```

### Race and Ethnicity

```{r process-ethnicity-data}
ethnicity_summary <- dm$ethnicity |>
    dplyr::semi_join(
        y = entries_in_period,
        by = c("personal_id", "organization_id")
    ) |>
    dplyr::summarise(
        n_ethnicities = sum(ethnicity != "Missing"),
        n_missing = sum(ethnicity == "Missing"),
        .by = c("personal_id", "organization_id")
    )

data_ethnicity <- entries_in_period |>
    dplyr::left_join(
        y = ethnicity_summary,
        by = c("personal_id", "organization_id")
    )
```

```{r check-etchnicity-count}
data_ethnicity |>
    dplyr::count(n_ethnicities) |>
    gt::gt() |>
    gt::tab_header(
        title = "Client Self-Identified Race/Ethnicity Selections"
    ) |>
    gt::cols_label(
        n_ethnicities = "Number of Identities Selected",
        n = "Count"
    ) |>
    gt::cols_align(
        align = "left",
        columns = n_ethnicities
    ) |>
    gt::tab_options(
        table.font.names = "Roboto"
    )
```

```{r check-correct-missing}
#| results: asis
problematic_records <- data_ethnicity |>
    dplyr::filter(n_missing == 1, n_ethnicities > 0)

n_problematic <- nrow(problematic_records)

if (n_problematic == 0) {
    cat("✅ No records have missing alongside other valid ethnicity values.")
} else {
    cat(paste0("❌ ", n_problematic, " records have missing alongside other valid ethnicity values."))
}
```

### Veteran Status

```{r check-veteran-status-responses}
data_enrollment_client |>
    create_data_quality_table(
        response_column = "veteran_status",
        group_column = "is_adult",
        group_column_label = "Adult",
        table_title = "Veteran Status"
    )
```

### Relationship to Head of Household

```{r check-relationship-to-head-of-household-responses}
data_enrollment_client |>
    create_data_quality_table(
        response_column = "relationship_to_ho_h",
        no_response_values = c(
            "Data not collected",
            "Missing"
        ),
        table_title = "Relationship to Head of Household"
    )
```

```{r check-heads-of-household-age}
data_enrollment_client |>
    dplyr::filter(relationship_to_ho_h == "Self (head of household)") |>
    dplyr::count(age_grouped, .drop = FALSE) |>
    ggplot2::ggplot() +
    ggplot2::geom_bar(
        mapping = ggplot2::aes(
            x = age_grouped,
            y = n
        ),
        stat = "identity",
        fill = palette$light_blue,
        color = palette$navy_blue
    ) +
    ggplot2::geom_text(
        mapping = ggplot2::aes(
            x = age_grouped,
            y = n,
            label = ifelse(n == 0, "", n)
        ),
        hjust = -0.2
    ) +
    ggplot2::coord_flip() +
    ggplot2::scale_y_continuous(expand = ggplot2::expansion(mult = c(0, 0.15))) +
    ggplot2::labs(
        title = "Heads of Household by Age",
        x = "Age (Years)",
        y = "Head of Household Count"
    ) +
    ggplot2::theme_bw()

```

### Living Situation
```{r check-living-situation-responses-entry}
data_enrollment_client |>
    create_data_quality_table(
        response_column = "living_situation",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Living Situation (Entry)"
    )
```

```{r check-living-situation-responses-exit}
data_exit |>
    create_data_quality_table(
        response_column = "destination",
        table_title = "Living Situation (Exit)"
    )
```

## Program Specific Data Elements

### Common Program Specific Data Elements

#### Income, Benefits and Insurance

```{r check-income-sources-record-match}
#| results: asis
check_record_match(
    data_entry = data_income_entry,
    entries = entries_in_period,
    data_exit = data_income_exit,
    exits = exits_in_period
)
```

##### Income and Sources

```{r check-income-responses-entry}
data_income_entry |>
    create_data_quality_table(
        response_column = "income_from_any_source",
        combine_responses = FALSE,
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Income from Any Source (Entry)"
    )
```

```{r check-income-detail-responses-entry}
data_detail_income_entry |>
    dplyr::count(
        is_hoh_and_or_adult,
        any_source_response_grouped,
        has_total_monthly_income,
        selected_one_or_more_sources
    ) |>
    gt::gt() |>
    gt::tab_header(
        title = "Detailed Income Analysis (Entry)"
    ) |>
    gt::cols_label(
        is_hoh_and_or_adult = "HoH and / or Adult",
        any_source_response_grouped = "Income from Any Source",
        has_total_monthly_income = "Reported Value",
        selected_one_or_more_sources = "Selected one or more Sources",
        n = "Count"
    ) |>
    gt::tab_options(
        table.font.names = "Roboto"
    )
```

```{r check-income-responses-exit}
data_income_exit |>
    create_data_quality_table(
        response_column = "income_from_any_source",
        combine_responses = FALSE,
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Income from Any Source (Exit)"
    )
```

```{r check-income-detail-responses-exit}
data_detail_income_exit |>
    dplyr::count(
        is_hoh_and_or_adult,
        any_source_response_grouped,
        has_total_monthly_income,
        selected_one_or_more_sources
    ) |>
    gt::gt() |>
    gt::tab_header(
        title = "Detailed Income Analysis (Exit)"
    ) |>
    gt::cols_label(
        is_hoh_and_or_adult = "HoH and / or Adult",
        any_source_response_grouped = "Income from Any Source",
        has_total_monthly_income = "Reported Value",
        selected_one_or_more_sources = "Selected one or more Sources",
        n = "Count"
    ) |>
    gt::tab_options(
        table.font.names = "Roboto"
    )
```

##### Non-Cash Benefits

```{r check-benefits-responses-entry}
data_benefits_entry |>
    create_data_quality_table(
        response_column = "benefits_from_any_source",
        combine_responses = FALSE,
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Benefits from Any Source (Entry)"
    )
```

```{r check-benefits-detail-responses-entry}
data_detail_benefits_entry |>
    dplyr::count(
        is_hoh_and_or_adult,
        any_source_response_grouped,
        selected_one_or_more_sources
    ) |>
    gt::gt() |>
    gt::tab_header(
        title = "Detailed Benefits Analysis (Entry)"
    ) |>
    gt::cols_label(
        is_hoh_and_or_adult = "HoH and / or Adult",
        any_source_response_grouped = "Benefits from Any Source",
        selected_one_or_more_sources = "Selected one or more Sources",
        n = "Count"
    ) |>
    gt::tab_options(
        table.font.names = "Roboto"
    )
```

```{r check-benefits-responses-exit}
data_benefits_exit |>
    create_data_quality_table(
        response_column = "benefits_from_any_source",
        combine_responses = FALSE,
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Benefits from Any Source (Exit)"
    )
```

```{r check-benefits-detail-responses-exit}
data_detail_benefits_exit |>
    dplyr::count(
        is_hoh_and_or_adult,
        any_source_response_grouped,
        selected_one_or_more_sources
    ) |>
    gt::gt() |>
    gt::tab_header(
        title = "Detailed Benefits Analysis (Exit)"
    ) |>
    gt::cols_label(
        is_hoh_and_or_adult = "HoH and / or Adult",
        any_source_response_grouped = "Benefits from Any Source",
        selected_one_or_more_sources = "Selected one or more Sources",
        n = "Count"
    ) |>
    gt::tab_options(
        table.font.names = "Roboto"
    )
```

##### Health Insurance

```{r check-health-insurance-responses-entry}
data_health_insurance_entry |>
    create_data_quality_table(
        response_column = "insurance_from_any_source",
        combine_responses = FALSE,
        table_title = "Insurance from Any Source (Entry)"
    )
```

```{r check-health-insurance-detail-responses-entry}
data_detail_health_insurance_entry |>
    dplyr::count(
        any_source_response_grouped,
        selected_one_or_more_sources
    ) |>
    gt::gt() |>
    gt::tab_header(
        title = "Detailed Heath Insurance Analysis (Entry)"
    ) |>
    gt::cols_label(
        any_source_response_grouped = "Insurance from Any Source",
        selected_one_or_more_sources = "Selected one or more Sources",
        n = "Count"
    ) |>
    gt::tab_options(
        table.font.names = "Roboto"
    )
```

```{r check-health-insurance-responses-exit}
data_health_insurance_exit |>
    create_data_quality_table(
        response_column = "insurance_from_any_source",
        combine_responses = FALSE,
        table_title = "Insurance from Any Source (Exit)"
    )
```

```{r check-health-insurance-detail-responses-exit}
data_detail_health_insurance_exit |>
    dplyr::count(
        any_source_response_grouped,
        selected_one_or_more_sources
    ) |>
    gt::gt() |>
    gt::tab_header(
        title = "Detailed Health Insurance Analysis (Exit)"
    ) |>
    gt::cols_label(
        any_source_response_grouped = "Insurance from Any Source",
        selected_one_or_more_sources = "Selected one or more Sources",
        n = "Count"
    ) |>
    gt::tab_options(
        table.font.names = "Roboto"
    )
```

#### Health Conditions and Disabilities

```{r check-health-conditions-disabilites-record-match}
#| results: asis
check_record_match(
    data_entry = data_health_conditions_and_disabilites_entry,
    entries = entries_in_period,
    data_exit = data_health_conditions_and_disabilites_exit,
    exits = exits_in_period
)
```

##### Physical Disability

```{r check-physical-disability-responses-entry}
data_health_conditions_and_disabilites_entry |>
    dplyr::filter(disability_type == "Physical Disability") |>
    create_data_quality_table(
        response_column = "disability_response",
        table_title = "Physical Disability (Entry)"
    )
```

```{r check-physical-disability-responses-exit}
data_health_conditions_and_disabilites_exit |>
    dplyr::filter(disability_type == "Physical Disability") |>
    create_data_quality_table(
        response_column = "disability_response",
        table_title = "Physical Disability (Exit)"
    )
```

##### Developmental Disability

```{r check-developmental-disability-responses-entry}
data_health_conditions_and_disabilites_entry |>
    dplyr::filter(disability_type == "Developmental Disability") |>
    create_data_quality_table(
        response_column = "disability_response",
        table_title = "Developmental Disability (Entry)"
    )
```

```{r check-developmental-disability-responses-exit}
data_health_conditions_and_disabilites_exit |>
    dplyr::filter(disability_type == "Developmental Disability") |>
    create_data_quality_table(
        response_column = "disability_response",
        table_title = "Developmental Disability (Exit)"
    )
```

##### Chronic Health Condition

```{r check-chronic-health-condition-responses-entry}
data_health_conditions_and_disabilites_entry |>
    dplyr::filter(disability_type == "Chronic Health Condition") |>
    create_data_quality_table(
        response_column = "disability_response",
        table_title = "Chronic Health Condition (Entry)"
    )
```

```{r check-chronic-health-condition-responses-exit}
data_health_conditions_and_disabilites_exit |>
    dplyr::filter(disability_type == "Chronic Health Condition") |>
    create_data_quality_table(
        response_column = "disability_response",
        table_title = "Chronic Health Condition (Exit)"
    )
```

##### HIV/AIDS

```{r check-hiv-aids-responses-entry}
data_health_conditions_and_disabilites_entry |>
    dplyr::filter(disability_type == "HIV/AIDS") |>
    create_data_quality_table(
        response_column = "disability_response",
        table_title = "HIV/AIDS (Entry)"
    )
```

```{r check-hiv-aids-responses-exit}
data_health_conditions_and_disabilites_exit |>
    dplyr::filter(disability_type == "HIV/AIDS") |>
    create_data_quality_table(
        response_column = "disability_response",
        table_title = "HIV/AIDS (Exit)"
    )
```
##### Mental Health Disorder

```{r check-mental-health-disorder-responses-entry}
data_health_conditions_and_disabilites_entry |>
    dplyr::filter(disability_type == "Mental Health Disorder") |>
    create_data_quality_table(
        response_column = "disability_response",
        table_title = "Mental Health Disorder (Entry)"
    )
```

```{r check-mental-health-disorder-responses-exit}
data_health_conditions_and_disabilites_exit |>
    dplyr::filter(disability_type == "Mental Health Disorder") |>
    create_data_quality_table(
        response_column = "disability_response",
        table_title = "Mental Health Disorder (Exit)"
    )
```

##### Substance Use Disorder

```{r check-substance-use-disorder-responses-entry}
data_health_conditions_and_disabilites_entry |>
    dplyr::filter(disability_type == "Substance Use Disorder") |>
    create_data_quality_table(
        response_column = "disability_response",
        table_title = "Substance Use Disorder (Entry)"
    )
```

```{r check-substance-use-disorder-responses-exit}
data_health_conditions_and_disabilites_exit |>
    dplyr::filter(disability_type == "Substance Use Disorder") |>
    create_data_quality_table(
        response_column = "disability_response",
        table_title = "Substance Use Disorder (Exit)"
    )
```

#### Domestic Violence

```{r check-domestic-violence-record-match}
#| results: asis
check_record_match(
    data_entry = data_domestic_violence_entry,
    entries = entries_in_period
)
```

```{r check-domestic-violence-responses-entry}
data_domestic_violence_entry |>
    create_data_quality_table(
        response_column = "domestic_violence_survivor",
        combine_responses = FALSE,
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Domestic Violence Survivor (Entry)"
    )
```

```{r check-when-occurred-responses-entry}
data_domestic_violence_entry |>
    create_data_quality_table(
        response_column = "when_occurred",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "When Occurred (Entry)"
    )
```

```{r check-currently-fleeing-responses-entry}
data_domestic_violence_entry |>
    create_data_quality_table(
        response_column = "currently_fleeing",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Currently Fleeing (Entry)"
    )
```

### Federal Partner Program Specific Data Elements

#### RHY

##### Referral Source

```{r check-referral-source-responses}
data_enrollment_client |>
    create_data_quality_table(
        response_column = "referral_source",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Referral Source"
    )
```

##### Education

```{r check-education-record-match}
#| results: asis
check_record_match(
    data_entry = data_education_entry,
    entries = entries_in_period,
    data_exit = data_education_exit,
    exits = exits_in_period
)
```

###### Last Grade Completed

```{r check-last-grade-completed-responses-entry}
data_education_entry |>
    create_data_quality_table(
        response_column = "last_grade_completed",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Last Grade Completed (Entry)"
    )
```

```{r check-last-grade-completed-responses-exit}
data_education_exit |>
    create_data_quality_table(
        response_column = "last_grade_completed",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Last Grade Completed (Exit)"
    )
```

###### School Status

```{r check-school-status-responses-entry}
data_education_entry |>
    create_data_quality_table(
        response_column = "school_status",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "School Status (Entry)"
    )
```

```{r check-school-status-responses-exit}
data_education_exit |>
    create_data_quality_table(
        response_column = "school_status",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "School Status (Exit)"
    )
```

##### Employment Status

```{r check-employment-record-match}
#| results: asis
check_record_match(
    data_entry = data_employment_entry,
    entries = entries_in_period,
    data_exit = data_employment_exit,
    exits = exits_in_period
)
```

```{r check-employed-responses-entry}
data_employment_entry |>
    create_data_quality_table(
        response_column = "employed",
        combine_responses = FALSE,
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Employment Status (Entry)"
    )
```

```{r check-employment-type-responses-entry}
data_employment_entry |>
    create_data_quality_table(
        response_column = "employment_type",
        no_response_values = "Missing",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Employment Type (Entry)"
    )
```

```{r check-not-employed-reason-responses-entry}
data_employment_entry |>
    create_data_quality_table(
        response_column = "not_employed_reason",
        no_response_values = "Missing",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Not Employed Reason (Entry)"
    )
```

```{r check-employed-responses-exit}
data_employment_exit |>
    create_data_quality_table(
        response_column = "employed",
        combine_responses = FALSE,
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Employment Status (Exit)"
    )
```

```{r check-employment-type-responses-exit}
data_employment_exit |>
    create_data_quality_table(
        response_column = "employment_type",
        no_response_values = "Missing",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Employment Type (Exit)"
    )
```

```{r check-not-employed-reason-responses-exit}
data_employment_exit |>
    create_data_quality_table(
        response_column = "not_employed_reason",
        no_response_values = "Missing",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Not Employed Reason (Exit)"
    )
```

##### Health Status

```{r check-health-status-record-match}
#| results: asis
check_record_match(
    data_entry = data_health_entry,
    entries = entries_in_period,
    data_exit = data_health_exit,
    exits = exits_in_period
)
```

###### General Health Status

```{r check-general-health-responses-entry}
data_health_entry |>
    create_data_quality_table(
        response_column = "general_health_status",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "General Health Status (Entry)"
    )
```

```{r check-general-health-responses-exit}
data_health_exit |>
    create_data_quality_table(
        response_column = "general_health_status",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "General Health Status (Exit)"
    )
```

###### Dental Health Status

```{r check-dental-health-responses-entry}
data_health_entry |>
    create_data_quality_table(
        response_column = "dental_health_status",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Dental Health Status (Entry)"
    )
```

```{r check-dental-health-responses-exit}
data_health_exit |>
    create_data_quality_table(
        response_column = "dental_health_status",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Dental Health Status (Exit)"
    )
```

###### Mental Health Status

```{r check-mental-health-responses-entry}
data_health_entry |>
    create_data_quality_table(
        response_column = "mental_health_status",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Mental Health Status (Entry)"
    )
```

```{r check-mental-health-responses-exit}
data_health_exit |>
    create_data_quality_table(
        response_column = "mental_health_status",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Mental Health Status (Exit)"
    )
```

###### Pregnancy Status

```{r check-pregnancy-responses-entry}
data_health_entry |>
    create_data_quality_table(
        response_column = "pregnancy_status",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Pregnancy Status (Entry)"
    )
```

```{r check-pregnancy-responses-exit}
data_health_exit |>
    create_data_quality_table(
        response_column = "pregnancy_status",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Pregnancy Status (Exit)"
    )
```

##### Formerly a Ward of Child Welfare/Foster Care Agency

```{r check-formerly-ward-of-child-welfare-foster-care-agency}
data_enrollment_client |>
    create_data_quality_table(
        response_column = "former_ward_child_welfare",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Formerly a Ward of Child Welfare/Foster Care Agency"
    )
```

##### Formerly a Ward of Juvenile Justice System

```{r check-formerly-ward-of-juvenile-justice-system}
data_enrollment_client |>
    create_data_quality_table(
        response_column = "former_ward_juvenile_justice",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Formerly a Ward of Juvenile Justice System"
    )
```

##### Commercial Sexual Exploitation / Sex Trafficking

```{r check-exchange-for-sex-responses}
data_exit |>
    create_data_quality_table(
        response_column = "exchange_for_sex",
        combine_responses = FALSE,
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Exchange for Sex (Exit)"
    )
```

```{r check-count-exchange-for-sex-responses}
data_exit |>
    create_data_quality_table(
        response_column = "count_of_exchange_for_sex",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Count Exchange for Sex (Exit)"
    )
```

```{r check-asked-or-forced-to-exchange-for-sex-responses}
data_exit |>
    create_data_quality_table(
        response_column = "asked_or_forced_to_exchange_for_sex",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Asked or Forced to Exchange for Sex (Exit)"
    )
```

##### Labor Exploitation / Trafficking

```{r check-workplace-violence-threats-promise-difference-responses-hoh-adults}
data_exit |>
    dplyr::filter(is_hoh_and_or_adult == "Yes") |>
    create_data_quality_table(
        response_column = "work_place_violence_threats",
        response_column_label = "Workplace Violence Threats",
        combine_responses = FALSE,
        group_column = "workplace_promise_difference",
        group_column_label = "Workplace Promise Difference",
        table_title = "Workplace Violence Threats / Promise Difference (Exit)",
        table_subtitle = "Head of Households and/or Adults"
    ) |>
    gt::cols_width(
        data_quality_status ~ gt::pct(28),
        `Missing` ~ gt::pct(13),
        `Data not collected` ~ gt::pct(15),
        `Client prefers not to answer` ~ gt::pct(19),
        `Client doesn't know` ~ gt::pct(13),
        `Yes` ~ gt::pct(8),
        `No` ~ gt::pct(8)
    )
```

```{r check-workplace-violence-threats-promise-difference-responses-not-hoh-adults}
data_exit |>
    dplyr::filter(is_hoh_and_or_adult == "No") |>
    create_data_quality_table(
        response_column = "work_place_violence_threats",
        response_column_label = "Workplace Violence Threats",
        combine_responses = FALSE,
        group_column = "workplace_promise_difference",
        group_column_label = "Workplace Promise Difference",
        table_title = "Workplace Violence Threats / Promise Difference (Exit)",
        table_subtitle = "Children and Youth (Not Head of Household)"
    ) |>
    gt::cols_width(
        data_quality_status ~ gt::pct(28),
        `Missing` ~ gt::pct(13),
        `Data not collected` ~ gt::pct(15),
        `Client prefers not to answer` ~ gt::pct(19),
        `Client doesn't know` ~ gt::pct(13),
        `Yes` ~ gt::pct(8),
        `No` ~ gt::pct(8)
    )
```

```{r check-coerced-to-continue-work-responses}
data_exit |>
    create_data_quality_table(
        response_column = "coerced_to_continue_work",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Coerced to Continue Work (Exit)"
    )
```

##### Project Completion Status

```{r check-project-completion-status-responses}
data_exit |>
    create_data_quality_table(
        response_column = "project_completion_status",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Project Completion Status (Exit)"
    )
```

##### Counseling

```{r check-counseling-responses}
data_exit |>
    create_data_quality_table(
        response_column = "counseling_received",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Counseling (Exit)"
    )
```

##### Safe and Appropriate Exit

```{r check-destination-safe-client-responses}
data_exit |>
    create_data_quality_table(
        response_column = "destination_safe_client",
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Destination Safe Client (Exit)"
    )
```

```{r check-destination-safe-worker-responses}
data_exit |>
    create_data_quality_table(
        response_column = "destination_safe_worker",
        no_response_values = c("Worker does not know", "Missing"),
        group_column = "is_hoh_and_or_adult",
        group_column_label = "Head of Household and/or Adult",
        table_title = "Destination Safe Worker (Exit)"
    )
```
